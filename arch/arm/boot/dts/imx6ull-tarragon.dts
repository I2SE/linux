#include "imx6ull-tarragon.dtsi"

/ {
	leds {
		compatible = "gpio-leds";
		pinctrl-names = "default";
		pinctrl-0 = <&pinctrl_debug_leds>;

		led1 {			/* Boot process */
			label = "evse:green:led1";
			gpios = <&gpio4 6 GPIO_ACTIVE_HIGH>;
			linux,default-trigger = "timer";
		};

		led2 {			/* CAN traffic */
			label = "evse:yellow:led2";
			gpios = <&gpio4 7 GPIO_ACTIVE_HIGH>;
			linux,default-trigger = "can0-rx";
		};

		led3 {			/* Heartbeat */
			label = "evse:red:led3";
			gpios = <&gpio3 19 GPIO_ACTIVE_HIGH>;
			linux,default-trigger = "heartbeat";
		};
	};
};

&i2c4 {
	pmic: pfuze3001@08 {
		compatible = "fsl,pfuze3001";
		reg = <0x08>;

		regulators {
			sw1_reg: sw1 {
				regulator-min-microvolt = <700000>;
				regulator-max-microvolt = <3300000>;
				regulator-boot-on;
				regulator-always-on;
			};

			sw2_reg: sw2 {
				regulator-min-microvolt = <1500000>;
				regulator-max-microvolt = <3300000>;
				regulator-boot-on;
				regulator-always-on;
			};

			sw3_reg: sw3 {
				regulator-min-microvolt = <900000>;
				regulator-max-microvolt = <1650000>;
				regulator-boot-on;
				regulator-always-on;
			};

			snvs_reg: vsnvs {
				regulator-min-microvolt = <1000000>;
				regulator-max-microvolt = <3000000>;
				regulator-boot-on;
				regulator-always-on;
			};

			vgen1_reg: vldo1 {
				regulator-min-microvolt = <1800000>;
				regulator-max-microvolt = <3300000>;
				regulator-always-on;
			};

			vgen2_reg: vldo2 {
				regulator-min-microvolt = <800000>;
				regulator-max-microvolt = <1550000>;
				regulator-always-on;
			};

			vgen3_reg: vccsd {
				regulator-min-microvolt = <2850000>;
				regulator-max-microvolt = <3300000>;
				regulator-always-on;
			};

			vgen4_reg: v33 {
				regulator-min-microvolt = <2850000>;
				regulator-max-microvolt = <3300000>;
				regulator-always-on;
			};

			vgen5_reg: vldo3 {
				regulator-min-microvolt = <1800000>;
				regulator-max-microvolt = <3300000>;
				regulator-always-on;
			};

			vgen6_reg: vldo4 {
				regulator-min-microvolt = <1800000>;
				regulator-max-microvolt = <3300000>;
				regulator-always-on;
			};
		};
	};

	ds2484@20 {
		compatible = "dallas,ds2482"; // FIXME
		reg = <0x20>;
	};

	atecc508@60 {
		compatible = "atmel,atecc508"; // FIXME
		reg = <0x60>;
	};
};

&usbotg1 {
	dr_mode = "otg";
	vbus-supply = <&reg_usb_vbus>;
	status = "okay";
};

&usdhc2 {
	pinctrl-names = "default", "state_100mhz", "state_200mhz";
	pinctrl-0 = <&pinctrl_usdhc2_8bit>;
	pinctrl-1 = <&pinctrl_usdhc2_8bit_100MHz>;
	pinctrl-2 = <&pinctrl_usdhc2_8bit_200MHz>;
	bus-width = <8>;
	// mmc-ddr-1_8v;
	// mmc-hs200-1_8v;
	broken-cd;
	non-removable;
	// vmmc-supply = <&sw2_reg>;
	// vqmmc-supply = <&vgen6_reg>;
	// mmc-pwrseq = <&emmc_pwrseq>;
	status = "okay";
};
